{"version":3,"file":"attendance-settings.mjs","sources":["../src/components/common/GroupSelect.vue","../src/views/AdminSettings.vue","../src/settings.js"],"sourcesContent":["<template>\n\t<NcSelect\n\t\t:model-value=\"modelValue\"\n\t\t:options=\"options\"\n\t\t:placeholder=\"placeholder\"\n\t\t:multiple=\"true\"\n\t\t:disabled=\"disabled\"\n\t\tlabel=\"displayName\"\n\t\ttrack-by=\"id\"\n\t\t@update:model-value=\"$emit('update:modelValue', $event)\">\n\t\t<template #option=\"{ displayName }\">\n\t\t\t<span style=\"display: flex; align-items: center; gap: 8px;\">\n\t\t\t\t<AccountGroup :size=\"20\" />\n\t\t\t\t<span>{{ displayName }}</span>\n\t\t\t</span>\n\t\t</template>\n\t\t<template #selected-option=\"{ displayName }\">\n\t\t\t<span style=\"display: flex; align-items: center; gap: 8px;\">\n\t\t\t\t<AccountGroup :size=\"16\" />\n\t\t\t\t<span>{{ displayName }}</span>\n\t\t\t</span>\n\t\t</template>\n\t</NcSelect>\n</template>\n\n<script setup>\nimport { NcSelect } from '@nextcloud/vue'\nimport AccountGroup from 'vue-material-design-icons/AccountGroup.vue'\n\ndefineProps({\n\tmodelValue: {\n\t\ttype: Array,\n\t\tdefault: () => [],\n\t},\n\toptions: {\n\t\ttype: Array,\n\t\tdefault: () => [],\n\t},\n\tplaceholder: {\n\t\ttype: String,\n\t\tdefault: '',\n\t},\n\tdisabled: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n})\n\ndefineEmits(['update:modelValue'])\n</script>\n","<template>\n\t<div id=\"attendance-admin-settings\" data-test=\"admin-settings\">\n\t\t<NcSettingsSection :name=\"t('attendance', 'Attendance')\"\n\t\t\t:description=\"t('attendance', 'Configure attendance management and reminders')\" />\n\n\t\t<div v-if=\"loadingData\" class=\"loading-section\">\n\t\t\t<NcLoadingIcon :size=\"32\" />\n\t\t\t<p>{{ t('attendance', 'Loading settings …') }}</p>\n\t\t</div>\n\n\t\t<template v-else>\n\t\t\t<!-- TRANSLATORS: Admin settings section title. The \"Response summary\" is the main feature of this app - it shows attendance statistics on the appointment detail page, counting users by their Nextcloud group membership. Groups selected here will have their own sections in the summary; users not in these groups appear under \"Others\". -->\n\t\t\t<NcSettingsSection :name=\"t('attendance', 'Response summary groups')\"\n\t\t\t\t:description=\"t('attendance', 'Select which groups to include in response summaries. Users outside these groups will appear under Others. Leave empty to include all groups.')\"\n\t\t\t\tdata-test=\"section-tracking-groups\">\n\t\t\t\t<GroupSelect\n\t\t\t\t\tv-model=\"selectedGroups\"\n\t\t\t\t\t:options=\"availableGroups\"\n\t\t\t\t\t:placeholder=\"t('attendance', 'Select groups …')\"\n\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\tdata-test=\"select-whitelisted-groups\" />\n\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t{{ n('attendance', '%n group selected', '%n groups selected', selectedGroups.length, { n: selectedGroups.length }) }}\n\t\t\t\t</p>\n\t\t\t</NcSettingsSection>\n\n\t\t\t<!-- TRANSLATORS: Admin settings section title. Similar to groups above, but for Nextcloud Teams (formerly Circles). Teams selected here will have their own sections in the attendance statistics on the appointment detail page, showing how many team members responded yes/no/maybe. -->\n\t\t\t<NcSettingsSection v-if=\"teamsAvailable\" :name=\"t('attendance', 'Response summary teams')\"\n\t\t\t\t:description=\"t('attendance', 'Select which teams to include in response summaries. Team members will be grouped together like regular groups.')\"\n\t\t\t\tdata-test=\"section-tracking-teams\">\n\t\t\t\t<NcSelect\n\t\t\t\t\tv-model=\"selectedTeams\"\n\t\t\t\t\t:options=\"teamSearchResults\"\n\t\t\t\t\t:placeholder=\"t('attendance', 'Search and select teams …')\"\n\t\t\t\t\t:multiple=\"true\"\n\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t:loading=\"isSearchingTeams\"\n\t\t\t\t\t:filterable=\"false\"\n\t\t\t\t\tlabel=\"label\"\n\t\t\t\t\ttrack-by=\"id\"\n\t\t\t\t\tdata-test=\"select-whitelisted-teams\"\n\t\t\t\t\t@search=\"searchTeams\">\n\t\t\t\t\t<template #option=\"{ label }\">\n\t\t\t\t\t\t<span style=\"display: flex; align-items: center; gap: 8px;\">\n\t\t\t\t\t\t\t<AccountStar :size=\"20\" />\n\t\t\t\t\t\t\t<span>{{ label }}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #selected-option=\"{ label }\">\n\t\t\t\t\t\t<span style=\"display: flex; align-items: center; gap: 8px;\">\n\t\t\t\t\t\t\t<AccountStar :size=\"16\" />\n\t\t\t\t\t\t\t<span>{{ label }}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t</NcSelect>\n\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t{{ n('attendance', '%n team selected', '%n teams selected', selectedTeams.length, { n: selectedTeams.length }) }}\n\t\t\t\t</p>\n\t\t\t</NcSettingsSection>\n\n\t\t\t<NcSettingsSection :name=\"t('attendance', 'Permissions')\"\n\t\t\t\t:description=\"t('attendance', 'Configure which groups can perform specific actions. Users must belong to at least one of the selected groups to access the feature. If no group is selected, all users have access to the feature.')\">\n\t\t\t\t<div class=\"subsection\">\n\t\t\t\t\t<h4>{{ t('attendance', 'Manage appointments') }}</h4>\n\t\t\t\t\t<p class=\"subsection-hint\">\n\t\t\t\t\t\t{{ t('attendance', 'Groups that can create, update, and delete appointments') }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<GroupSelect\n\t\t\t\t\t\tv-model=\"selectedManageAppointmentsRoles\"\n\t\t\t\t\t\t:options=\"availableGroups\"\n\t\t\t\t\t\t:placeholder=\"t('attendance', 'Select groups …')\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\tdata-test=\"select-manage-appointments-roles\" />\n\t\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t\t{{ n('attendance', '%n group selected', '%n groups selected', selectedManageAppointmentsRoles.length, { n: selectedManageAppointmentsRoles.length }) }}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"subsection\">\n\t\t\t\t\t<h4>{{ t('attendance', 'Check-in access') }}</h4>\n\t\t\t\t\t<p class=\"subsection-hint\">\n\t\t\t\t\t\t{{ t('attendance', 'Groups that can access the check-in interface and execute check-ins') }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<GroupSelect\n\t\t\t\t\t\tv-model=\"selectedCheckinRoles\"\n\t\t\t\t\t\t:options=\"availableGroups\"\n\t\t\t\t\t\t:placeholder=\"t('attendance', 'Select groups …')\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\tdata-test=\"select-checkin-roles\" />\n\t\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t\t{{ n('attendance', '%n group selected', '%n groups selected', selectedCheckinRoles.length, { n: selectedCheckinRoles.length }) }}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"subsection\">\n\t\t\t\t\t<h4>{{ t('attendance', 'See response & check-in summary') }}</h4>\n\t\t\t\t\t<p class=\"subsection-hint\">\n\t\t\t\t\t\t{{ t('attendance', 'Groups that can see the response summary and check-in summary') }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<GroupSelect\n\t\t\t\t\t\tv-model=\"selectedSeeResponseOverviewRoles\"\n\t\t\t\t\t\t:options=\"availableGroups\"\n\t\t\t\t\t\t:placeholder=\"t('attendance', 'Select groups …')\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\tdata-test=\"select-see-response-overview-roles\" />\n\t\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t\t{{ n('attendance', '%n group selected', '%n groups selected', selectedSeeResponseOverviewRoles.length, { n: selectedSeeResponseOverviewRoles.length }) }}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"subsection\">\n\t\t\t\t\t<h4>{{ t('attendance', 'See comments') }}</h4>\n\t\t\t\t\t<p class=\"subsection-hint\">\n\t\t\t\t\t\t{{ t('attendance', 'Groups that can see comments in the response overview') }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<GroupSelect\n\t\t\t\t\t\tv-model=\"selectedSeeCommentsRoles\"\n\t\t\t\t\t\t:options=\"availableGroups\"\n\t\t\t\t\t\t:placeholder=\"t('attendance', 'Select groups …')\"\n\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\tdata-test=\"select-see-comments-roles\" />\n\t\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t\t{{ n('attendance', '%n group selected', '%n groups selected', selectedSeeCommentsRoles.length, { n: selectedSeeCommentsRoles.length }) }}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</NcSettingsSection>\n\n\t\t\t<NcSettingsSection :name=\"t('attendance', 'Appointment reminders')\"\n\t\t\t\t:description=\"t('attendance', 'Send automatic reminder notifications to users who haven\\'t responded to appointments.')\">\n\t\t\t\t<NcNoteCard v-if=\"!notificationsAppEnabled\" type=\"warning\">\n\t\t\t\t\t<p>{{ t('attendance', 'The Notifications app is not enabled. Please enable it to use appointment reminders.') }}</p>\n\t\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t\t{{ t('attendance', 'You can enable it in the Apps section of your Nextcloud settings.') }}\n\t\t\t\t\t</p>\n\t\t\t\t</NcNoteCard>\n\n\t\t\t\t<template v-else>\n\t\t\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t\t\tv-model=\"remindersEnabled\"\n\t\t\t\t\t\ttype=\"switch\"\n\t\t\t\t\t\tdata-test=\"switch-reminders-enabled\">\n\t\t\t\t\t\t{{ t('attendance', 'Enable automatic reminders') }}\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t\t\t<div v-if=\"remindersEnabled\" class=\"reminder-config\">\n\t\t\t\t\t\t<NcInputField\n\t\t\t\t\t\t\tv-model.number=\"reminderDays\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t:label=\"t('attendance', 'Days before appointment')\"\n\t\t\t\t\t\t\t:helper-text=\"t('attendance', 'Send reminders this many days before the appointment (1-30 days)')\"\n\t\t\t\t\t\t\tdata-test=\"input-reminder-days\"\n\t\t\t\t\t\t\t:input-props=\"{ min: 1, max: 30 }\" />\n\n\t\t\t\t\t\t<NcInputField\n\t\t\t\t\t\t\tv-model.number=\"reminderFrequency\"\n\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\tclass=\"reminder-frequency-field\"\n\t\t\t\t\t\t\t:label=\"t('attendance', 'Reminder frequency (days)')\"\n\t\t\t\t\t\t\t:helper-text=\"t('attendance', 'How often to remind users who haven\\'t responded. Set to 0 to only remind once, or 1-30 to repeat reminders every N days.')\"\n\t\t\t\t\t\t\tdata-test=\"input-reminder-frequency\"\n\t\t\t\t\t\t\t:input-props=\"{ min: 0, max: 30 }\" />\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</NcSettingsSection>\n\n\t\t\t<div id=\"calendar-sync\">\n\t\t\t\t<NcSettingsSection\n\t\t\t\t\t:name=\"t('attendance', 'Calendar sync')\"\n\t\t\t\t\t:description=\"t('attendance', 'Automatically update attendance appointments when their linked calendar events are modified.')\">\n\t\t\t\t\t<NcNoteCard v-if=\"!calendarSyncAvailable\" type=\"warning\">\n\t\t\t\t\t\t<p>{{ t('attendance', 'Calendar sync requires Nextcloud 32 or newer.') }}</p>\n\t\t\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t\t\t{{ t('attendance', 'This feature uses calendar event hooks that are only available in Nextcloud 32 and later versions.') }}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</NcNoteCard>\n\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t\t\t\tv-model=\"calendarSyncEnabled\"\n\t\t\t\t\t\t\ttype=\"switch\"\n\t\t\t\t\t\t\tdata-test=\"switch-calendar-sync-enabled\">\n\t\t\t\t\t\t\t{{ t('attendance', 'Enable automatic calendar sync') }}\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t\t<p class=\"hint-text\">\n\t\t\t\t\t\t\t{{ t('attendance', 'When enabled, changes to calendar events will automatically update linked attendance appointments (title, description, date/time).') }}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</template>\n\t\t\t\t</NcSettingsSection>\n\t\t\t</div>\n\n\t\t\t<NcSettingsSection>\n\t\t\t\t<NcButton\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\tdata-test=\"button-save-settings\"\n\t\t\t\t\t@click=\"saveSettings\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<NcLoadingIcon v-if=\"loading\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('attendance', 'Save') }}\n\t\t\t\t</NcButton>\n\t\t\t</NcSettingsSection>\n\t\t</template>\n\t</div>\n</template>\n\n<script setup>\nimport { ref, onMounted, nextTick } from 'vue'\nimport { generateUrl } from '@nextcloud/router'\nimport { showSuccess, showError } from '@nextcloud/dialogs'\nimport axios from '@nextcloud/axios'\nimport {\n\tNcSelect,\n\tNcButton,\n\tNcLoadingIcon,\n\tNcSettingsSection,\n\tNcCheckboxRadioSwitch,\n\tNcInputField,\n\tNcNoteCard,\n} from '@nextcloud/vue'\nimport AccountStar from 'vue-material-design-icons/AccountStar.vue'\nimport GroupSelect from '../components/common/GroupSelect.vue'\n\n// State\nconst availableGroups = ref([])\nconst selectedGroups = ref([])\nconst selectedTeams = ref([])\nconst teamSearchResults = ref([])\nconst isSearchingTeams = ref(false)\nconst teamsAvailable = ref(false)\nconst selectedManageAppointmentsRoles = ref([])\nconst selectedCheckinRoles = ref([])\nconst selectedSeeResponseOverviewRoles = ref([])\nconst selectedSeeCommentsRoles = ref([])\nconst remindersEnabled = ref(false)\nconst reminderDays = ref(7)\nconst reminderFrequency = ref(0)\nconst notificationsAppEnabled = ref(true)\nconst calendarSyncEnabled = ref(false)\nconst calendarSyncAvailable = ref(false)\nconst loading = ref(false)\nconst loadingData = ref(true)\n\n// Methods\nconst loadSettings = async () => {\n\tloadingData.value = true\n\n\ttry {\n\t\tconst response = await axios.get(\n\t\t\tgenerateUrl('/apps/attendance/api/admin/settings'),\n\t\t)\n\n\t\tif (response.data.success) {\n\t\t\tavailableGroups.value = response.data.groups\n\t\t\t// Convert selected IDs to selected group objects for NcSelect, preserving database order\n\t\t\tselectedGroups.value = response.data.whitelistedGroups\n\t\t\t\t.map(id => response.data.groups.find(group => group.id === id))\n\t\t\t\t.filter(group => group !== undefined)\n\n\t\t\t// Load teams settings\n\t\t\tteamsAvailable.value = response.data.teamsAvailable || false\n\t\t\tif (response.data.whitelistedTeams) {\n\t\t\t\tselectedTeams.value = response.data.whitelistedTeams\n\t\t\t\t// Also add to search results so they appear in the dropdown\n\t\t\t\tteamSearchResults.value = [...response.data.whitelistedTeams]\n\t\t\t}\n\n\t\t\t// Load permission settings, preserving database order\n\t\t\tif (response.data.permissions) {\n\t\t\t\tselectedManageAppointmentsRoles.value = response.data.permissions.manage_appointments\n\t\t\t\t\t.map(id => response.data.groups.find(group => group.id === id))\n\t\t\t\t\t.filter(group => group !== undefined)\n\t\t\t\tselectedCheckinRoles.value = response.data.permissions.checkin\n\t\t\t\t\t.map(id => response.data.groups.find(group => group.id === id))\n\t\t\t\t\t.filter(group => group !== undefined)\n\t\t\t\tselectedSeeResponseOverviewRoles.value = (response.data.permissions.see_response_overview || [])\n\t\t\t\t\t.map(id => response.data.groups.find(group => group.id === id))\n\t\t\t\t\t.filter(group => group !== undefined)\n\t\t\t\tselectedSeeCommentsRoles.value = (response.data.permissions.see_comments || [])\n\t\t\t\t\t.map(id => response.data.groups.find(group => group.id === id))\n\t\t\t\t\t.filter(group => group !== undefined)\n\t\t\t}\n\n\t\t\t// Load reminder settings\n\t\t\tif (response.data.reminders) {\n\t\t\t\tremindersEnabled.value = response.data.reminders.enabled || false\n\t\t\t\treminderDays.value = response.data.reminders.reminderDays || 7\n\t\t\t\treminderFrequency.value = response.data.reminders.reminderFrequency || 0\n\t\t\t\tnotificationsAppEnabled.value = response.data.reminders.notificationsAppEnabled !== false\n\t\t\t}\n\n\t\t\t// Load calendar sync settings\n\t\t\tif (response.data.calendarSync) {\n\t\t\t\tcalendarSyncEnabled.value = response.data.calendarSync.enabled || false\n\t\t\t\tcalendarSyncAvailable.value = response.data.calendarSync.available || false\n\t\t\t}\n\t\t} else {\n\t\t\tshowError(window.t('attendance', 'Failed to load settings')\n\t\t\t\t+ (response.data.error ? ': ' + response.data.error : ''))\n\t\t}\n\t} catch (error) {\n\t\tconsole.error('Error loading settings:', error)\n\t\tshowError(window.t('attendance', 'Failed to load settings'))\n\t} finally {\n\t\tloadingData.value = false\n\t}\n}\n\nconst searchTeams = async (query) => {\n\tif (!query || query.length < 1) {\n\t\t// Keep selected teams visible in results\n\t\tteamSearchResults.value = [...selectedTeams.value]\n\t\treturn\n\t}\n\n\tisSearchingTeams.value = true\n\ttry {\n\t\tconst response = await axios.get(\n\t\t\tgenerateUrl('/apps/attendance/api/search/users-groups-teams'),\n\t\t\t{ params: { search: query } },\n\t\t)\n\t\t// Filter to only show teams\n\t\tconst teams = response.data\n\t\t\t.filter(item => item.type === 'team')\n\t\t\t.map(item => ({ id: item.id, label: item.label, type: 'team' }))\n\n\t\t// Merge with selected teams to keep them visible\n\t\tconst selectedIds = selectedTeams.value.map(t => t.id)\n\t\tconst newTeams = teams.filter(t => !selectedIds.includes(t.id))\n\t\tteamSearchResults.value = [...selectedTeams.value, ...newTeams]\n\t} catch (error) {\n\t\tconsole.error('Error searching teams:', error)\n\t} finally {\n\t\tisSearchingTeams.value = false\n\t}\n}\n\nconst saveSettings = async () => {\n\tloading.value = true\n\n\ttry {\n\t\tconst response = await axios.post(\n\t\t\tgenerateUrl('/apps/attendance/api/admin/settings'),\n\t\t\t{\n\t\t\t\twhitelistedGroups: selectedGroups.value.map(g => g.id),\n\t\t\t\twhitelistedTeams: selectedTeams.value.map(t => t.id),\n\t\t\t\tpermissions: {\n\t\t\t\t\tPERMISSION_MANAGE_APPOINTMENTS: selectedManageAppointmentsRoles.value.map(g => g.id),\n\t\t\t\t\tPERMISSION_CHECKIN: selectedCheckinRoles.value.map(g => g.id),\n\t\t\t\t\tPERMISSION_SEE_RESPONSE_OVERVIEW: selectedSeeResponseOverviewRoles.value.map(g => g.id),\n\t\t\t\t\tPERMISSION_SEE_COMMENTS: selectedSeeCommentsRoles.value.map(g => g.id),\n\t\t\t\t},\n\t\t\t\treminders: {\n\t\t\t\t\tenabled: remindersEnabled.value,\n\t\t\t\t\treminderDays: reminderDays.value,\n\t\t\t\t\treminderFrequency: reminderFrequency.value,\n\t\t\t\t},\n\t\t\t\tcalendarSync: {\n\t\t\t\t\tenabled: calendarSyncEnabled.value,\n\t\t\t\t},\n\t\t\t},\n\t\t)\n\n\t\tif (response.data.success) {\n\t\t\tshowSuccess(window.t('attendance', 'Settings saved'))\n\t\t} else {\n\t\t\tshowError(window.t('attendance', 'Failed to save settings')\n\t\t\t\t+ (response.data.error ? ': ' + response.data.error : ''))\n\t\t}\n\t} catch (error) {\n\t\tconsole.error('Error saving settings:', error)\n\t\tshowError(window.t('attendance', 'Failed to save settings'))\n\t} finally {\n\t\tloading.value = false\n\t}\n}\n\n// Lifecycle\nonMounted(async () => {\n\tawait loadSettings()\n\n\t// Handle hash navigation after content is loaded\n\tawait nextTick()\n\tif (window.location.hash) {\n\t\tconst element = document.querySelector(window.location.hash)\n\t\tif (element) {\n\t\t\telement.scrollIntoView({ behavior: 'smooth' })\n\t\t}\n\t}\n})\n</script>\n\n<style scoped>\n#attendance-admin-settings {\n\tpadding: 20px;\n\tmax-width: 900px;\n}\n\n.loading-section {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tgap: 12px;\n\tpadding: 40px;\n\tcolor: var(--color-text-maxcontrast);\n}\n\n.hint-text {\n\tmargin-top: 8px;\n\tcolor: var(--color-text-maxcontrast);\n\tfont-size: 13px;\n}\n\n.subsection {\n\tmargin: 24px 0;\n\tpadding-bottom: 24px;\n\tborder-bottom: 1px solid var(--color-border);\n}\n\n.subsection:last-child {\n\tborder-bottom: none;\n}\n\n.subsection h4 {\n\tmargin: 0 0 4px 0;\n\tfont-size: 15px;\n\tfont-weight: 600;\n}\n\n.subsection-hint {\n\tmargin: 0 0 12px 0;\n\tcolor: var(--color-text-maxcontrast);\n\tfont-size: 14px;\n}\n\n.reminder-config {\n\tmargin-top: 16px;\n\tmargin-bottom: 16px;\n\tmax-width: 300px;\n}\n\n.input-field.reminder-frequency-field {\n\tmargin-block-start: 40px;\n}\n</style>\n","/**\n * Admin settings Vue app entry point\n */\n\nimport { createApp } from 'vue'\nimport { translate, translatePlural } from '@nextcloud/l10n'\nimport AdminSettings from './views/AdminSettings.vue'\n\nconst app = createApp(AdminSettings)\n\n// Make translation functions available globally\napp.config.globalProperties.t = translate\napp.config.globalProperties.n = translatePlural\n\napp.mount('#attendance-admin-settings-vue')\n"],"names":["_createBlock","_unref","NcSelect","__props","_cache","$event","$emit","_withCtx","displayName","_createElementVNode","_hoisted_1","_createVNode","AccountGroup","_hoisted_2","availableGroups","ref","selectedGroups","selectedTeams","teamSearchResults","isSearchingTeams","teamsAvailable","selectedManageAppointmentsRoles","selectedCheckinRoles","selectedSeeResponseOverviewRoles","selectedSeeCommentsRoles","remindersEnabled","reminderDays","reminderFrequency","notificationsAppEnabled","calendarSyncEnabled","calendarSyncAvailable","loading","loadingData","loadSettings","response","axios","generateUrl","id","group","showError","error","searchTeams","query","teams","item","selectedIds","t","newTeams","saveSettings","g","showSuccess","onMounted","nextTick","element","_openBlock","_createElementBlock","NcSettingsSection","NcLoadingIcon","_Fragment","GroupSelect","_hoisted_3","_toDisplayString","n","label","_hoisted_4","AccountStar","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","NcCheckboxRadioSwitch","_hoisted_20","NcInputField","NcNoteCard","_hoisted_19","_hoisted_21","_hoisted_23","_hoisted_22","NcButton","_createTextVNode","app","createApp","AdminSettings","translate","translatePlural"],"mappings":"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"}