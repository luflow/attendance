{"version":3,"file":"attendance-quickresponse.mjs","sources":["../node_modules/vue-material-design-icons/Clock.vue","../src/views/QuickResponse.vue","../src/quickresponse.js"],"sourcesContent":["<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : 'true'\"\n        :aria-label=\"title\"\n        class=\"material-design-icon clock-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"ClockIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","<template>\n\t<div class=\"quick-response-container guest-box\" :data-nc-version=\"ncVersion\">\n\t\t<!-- Error State -->\n\t\t<template v-if=\"error\">\n\t\t\t<NcNoteCard type=\"error\">\n\t\t\t\t<h2>{{ t('attendance', 'Unable to process response') }}</h2>\n\t\t\t\t<p>{{ errorMessage }}</p>\n\t\t\t</NcNoteCard>\n\t\t\t<div class=\"button-row\">\n\t\t\t\t<NcButton variant=\"primary\" :href=\"appUrl\">\n\t\t\t\t\t{{ t('attendance', 'Open Attendance app') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</template>\n\n\t\t<!-- Success State -->\n\t\t<template v-else-if=\"confirmed\">\n\t\t\t<NcNoteCard type=\"success\">\n\t\t\t\t<h2>{{ t('attendance', 'Thank you for your response!') }}</h2>\n\t\t\t\t<p>{{ t('attendance', 'Your response has been saved.') }}</p>\n\t\t\t</NcNoteCard>\n\n\t\t\t<div class=\"appointment-details\">\n\t\t\t\t<h3>{{ appointmentName }}</h3>\n\t\t\t\t<p class=\"date-time\">\n\t\t\t\t\t<CalendarIcon :size=\"18\" />\n\t\t\t\t\t<strong>{{ formattedDate }}</strong>\n\t\t\t\t</p>\n\t\t\t\t<p class=\"date-time\">\n\t\t\t\t\t<ClockIcon :size=\"18\" />\n\t\t\t\t\t{{ formattedTime }}\n\t\t\t\t</p>\n\t\t\t\t<p class=\"response-display\">\n\t\t\t\t\t{{ t('attendance', 'Your response:') }}\n\t\t\t\t\t<NcChip :text=\"responseLabel\" :variant=\"responseVariant\" no-close />\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t<div class=\"button-row\">\n\t\t\t\t<NcButton :href=\"appointmentUrl\">\n\t\t\t\t\t{{ t('attendance', 'View appointment details') }}\n\t\t\t\t</NcButton>\n\t\t\t\t<NcButton variant=\"primary\" :href=\"appUrl\">\n\t\t\t\t\t{{ t('attendance', 'Open Attendance app') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</template>\n\n\t\t<!-- Confirmation State -->\n\t\t<template v-else>\n\t\t\t<h2>{{ t('attendance', 'Confirm your response?') }}</h2>\n\t\t\t<p class=\"responding-as\">\n\t\t\t\t{{ t('attendance', 'You are answering as {user}', { user: userName }) }}\n\t\t\t</p>\n\n\t\t\t<div class=\"appointment-details\">\n\t\t\t\t<h3>{{ appointmentName }}</h3>\n\t\t\t\t<p class=\"date-time\">\n\t\t\t\t\t<CalendarIcon :size=\"18\" />\n\t\t\t\t\t<strong>{{ formattedDate }}</strong>\n\t\t\t\t</p>\n\t\t\t\t<p class=\"date-time\">\n\t\t\t\t\t<ClockIcon :size=\"18\" />\n\t\t\t\t\t{{ formattedTime }}\n\t\t\t\t</p>\n\t\t\t\t<p class=\"response-display\">\n\t\t\t\t\t{{ t('attendance', 'You are about to respond with: {response}', { response: responseLabel }) }}\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t<div class=\"button-row\">\n\t\t\t\t<NcButton\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t:disabled=\"submitting\"\n\t\t\t\t\t@click=\"confirmResponse\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<NcLoadingIcon v-if=\"submitting\" :size=\"20\" />\n\t\t\t\t\t\t<CheckIcon v-else :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('attendance', 'Confirm response') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\n\t\t\t<div class=\"link-row\">\n\t\t\t\t<a :href=\"appointmentUrl\">{{ t('attendance', 'View appointment details') }}</a>\n\t\t\t\t<span class=\"separator\">Â·</span>\n\t\t\t\t<a :href=\"appUrl\">{{ t('attendance', 'Open Attendance app') }}</a>\n\t\t\t</div>\n\t\t</template>\n\t</div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport { NcButton, NcNoteCard, NcLoadingIcon, NcChip } from '@nextcloud/vue'\nimport { loadState } from '@nextcloud/initial-state'\nimport { generateUrl } from '@nextcloud/router'\nimport axios from '@nextcloud/axios'\nimport CalendarIcon from 'vue-material-design-icons/Calendar.vue'\nimport ClockIcon from 'vue-material-design-icons/Clock.vue'\nimport CheckIcon from 'vue-material-design-icons/Check.vue'\nimport { formatDate, formatTime } from '../utils/datetime.js'\nimport { getResponseVariant } from '../utils/response.js'\n\n// Load initial state from server\nconst initialState = loadState('attendance', 'quick-response-data', {})\n\n// Load NC version for CSS compatibility\nlet ncVersionState = 31\ntry {\n\tncVersionState = loadState('attendance', 'nc-version')\n} catch (error) {\n\tconsole.debug('nc-version not available, defaulting to 31')\n}\nconst ncVersion = ref(ncVersionState)\n\n// Reactive state\nconst error = ref(initialState.error || false)\nconst errorMessage = ref(initialState.errorMessage || '')\nconst confirmed = ref(initialState.confirmed || false)\nconst submitting = ref(false)\n\n// Appointment data\nconst appointmentId = initialState.appointmentId || 0\nconst appointmentName = initialState.appointmentName || ''\nconst appointmentDatetime = initialState.appointmentDatetime || ''\nconst response = initialState.response || ''\nconst responseLabel = initialState.responseLabel || ''\nconst token = initialState.token || ''\nconst userId = initialState.userId || ''\nconst userName = initialState.userName || ''\n\n// Computed date/time using app utilities\nconst formattedDate = computed(() => formatDate(appointmentDatetime, 'long'))\nconst formattedTime = computed(() => formatTime(appointmentDatetime))\n\n// Computed URLs\nconst appUrl = computed(() => generateUrl('/apps/attendance/'))\nconst appointmentUrl = computed(() => generateUrl('/apps/attendance/appointment/{id}', { id: appointmentId }))\n\n// Computed response variant for NcChip\nconst responseVariant = computed(() => getResponseVariant(response))\n\n// Methods\nconst confirmResponse = async () => {\n\tsubmitting.value = true\n\ttry {\n\t\tconst url = generateUrl('/apps/attendance/respond/{appointmentId}/confirm', { appointmentId })\n\t\tawait axios.post(url, {\n\t\t\tresponse,\n\t\t\ttoken,\n\t\t\tuserId,\n\t\t})\n\t\tconfirmed.value = true\n\t} catch (err) {\n\t\terror.value = true\n\t\terrorMessage.value = err.response?.data?.message || 'An error occurred while recording your response.'\n\t} finally {\n\t\tsubmitting.value = false\n\t}\n}\n</script>\n\n<style scoped lang=\"scss\">\n.quick-response-container {\n\tmax-width: 500px;\n\tmargin: 0 auto;\n\tpadding: 20px;\n\n\th2 {\n\t\tmargin-bottom: 10px;\n\t}\n}\n\n.responding-as {\n\tcolor: var(--color-text-maxcontrast);\n\tmargin-bottom: 20px;\n}\n\n.appointment-details {\n\tbackground: var(--color-background-hover);\n\tborder-radius: var(--border-radius-large);\n\tpadding: 16px;\n\tmargin: 20px 0;\n\n\th3 {\n\t\tmargin: 0 0 12px 0;\n\t}\n\n\t.date-time {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tmargin: 8px 0;\n\t\tcolor: var(--color-text-maxcontrast);\n\t}\n\n\t.response-display {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tmargin-top: 16px;\n\t}\n}\n\n.button-row {\n\tdisplay: flex;\n\tgap: 12px;\n\tjustify-content: center;\n\tmargin-top: 20px;\n\tflex-wrap: wrap;\n}\n\n.link-row {\n\tdisplay: flex;\n\tgap: 8px;\n\tjustify-content: center;\n\tmargin-top: 16px;\n\tfont-size: 14px;\n\n\ta {\n\t\tcolor: var(--color-primary-element);\n\t\ttext-decoration: none;\n\n\t\t&:hover {\n\t\t\ttext-decoration: underline;\n\t\t}\n\t}\n\n\t.separator {\n\t\tcolor: var(--color-text-maxcontrast);\n\t}\n}\n</style>\n\n<style>\n/* NcChip text color overrides for Nextcloud 31 */\n#attendance-quick-response [data-nc-version=\"31\"] .nc-chip--error .nc-chip__text,\n#attendance-quick-response [data-nc-version=\"31\"] .nc-chip--warning .nc-chip__text,\n#attendance-quick-response [data-nc-version=\"31\"] .nc-chip--success .nc-chip__text {\n\tcolor: white !important;\n}\n\n/* Dark Mode (explicit): Warning elements need black text for better contrast */\nbody[data-theme-dark] #attendance-quick-response [data-nc-version=\"31\"] .nc-chip--warning .nc-chip__text {\n\tcolor: black !important;\n}\n\n/* Dark Mode (system preference): Only when using default theme */\n@media (prefers-color-scheme: dark) {\n\tbody[data-theme-default] #attendance-quick-response [data-nc-version=\"31\"] .nc-chip--warning .nc-chip__text {\n\t\tcolor: black !important;\n\t}\n}\n</style>\n","/**\n * Quick Response Vue app entry point\n * Used for the public quick response confirmation page\n */\n\nimport { createApp } from 'vue'\nimport { translate, translatePlural } from '@nextcloud/l10n'\nimport QuickResponse from './views/QuickResponse.vue'\n\nconst app = createApp(QuickResponse)\n\n// Make translation functions available globally\napp.config.globalProperties.t = translate\napp.config.globalProperties.n = translatePlural\n\napp.mount('#attendance-quick-response')\n"],"names":["_sfc_main","_hoisted_3","_createElementBlock","_mergeProps","_ctx","$props","_cache","$event","_createElementVNode","_openBlock","initialState","loadState","ncVersionState","ncVersion","ref","error","errorMessage","confirmed","submitting","appointmentId","appointmentName","appointmentDatetime","response","responseLabel","token","userId","userName","formattedDate","computed","formatDate","formattedTime","formatTime","appUrl","generateUrl","appointmentUrl","responseVariant","getResponseVariant","confirmResponse","url","axios","err","_Fragment","_createVNode","_unref","NcNoteCard","t","_hoisted_2","NcButton","_hoisted_4","CalendarIcon","_hoisted_5","ClockIcon","_createTextVNode","_hoisted_6","NcChip","_hoisted_7","_hoisted_8","_toDisplayString","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_createBlock","NcLoadingIcon","CheckIcon","_hoisted_14","_hoisted_15","_hoisted_16","app","createApp","QuickResponse","translate","translatePlural"],"mappings":"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","x_google_ignoreList":[0]}